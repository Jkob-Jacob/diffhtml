!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).diff={})}(this,function(e){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function j(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(){return{rawNodeName:"",nodeName:"",nodeValue:"",nodeType:1,key:"",childNodes:[],attributes:{}}}var I={SET_ATTRIBUTE:0,REMOVE_ATTRIBUTE:1,NODE_VALUE:2,INSERT_BEFORE:3,REPLACE_CHILD:4,REMOVE_CHILD:5},p=new Map,L=new Map,m=new Map,d=new Set,M=new Set,v=new Set,A=new Set,c=new Set,r=new Set,l=Object.freeze({__proto__:null,StateCache:p,NodeCache:L,TransitionCache:m,MiddlewareCache:d,CreateTreeHookCache:M,CreateNodeHookCache:v,SyncTreeHookCache:A,ReleaseHookCache:c,ParserHookCache:r}),u=new Set,f=new Set,h=new Set,g={free:u,allocated:f,protected:h},N=u.values(),H={size:1e4,memory:g,fill:function(){for(var t=this,e=u.size;e<this.size;e++)u.add(s());this.size<u.size&&u.forEach(function(e){u.size!==t.size&&u.delete(e)})},get:function(){var e=N.next(),t=e.value,r=void 0===t?s():t;return e.done&&(N=u.values()),u.delete(r),f.add(r),r},protect:function(e){f.delete(e),h.add(e)},unprotect:function(e){h.has(e)?(h.delete(e),u.add(e)):f.has(e)&&(f.delete(e),u.add(e))}};H.fill();var P=Array.isArray,D=H.memory,z="#document-fragment",B="#text";function U(r,e,t){var n=null;if(D.protected.has(r)||D.allocated.has(r))n=r;else if(!r||P(r)){var a=r?r.length:0;t=[];for(var o=0;o<a;o++)t.push(r[o]);n=U(z,null,t)}if(n)return n;var i,s="object"==typeof r,d=r;if(r&&s&&"ownerDocument"in d){if(3===d.nodeType){var c=U(B,d.nodeValue);return L.set(c,r),c}e={},t=[];var l=d.attributes;if(1===d.nodeType&&l&&l.length)for(var u=0;u<l.length;u++){var f=l[u],h=f.name,p=f.value;""===p&&h in d?e[h]=r[h]:e[h]=p}if((1===d.nodeType||11===d.nodeType)&&d.childNodes.length){t=[];for(var v=0;v<d.childNodes.length;v++){var m=d.childNodes[v];t.push(U(m))}}return L.forEach(function(e,t){e===r&&(n=t)}),(n=n||U(d.nodeName,e,t)).attributes=e,n.childNodes.length=0,(i=n.childNodes).push.apply(i,j(t)),L.set(n,r),n}if(s){var g=r.rawNodeName,N=r.nodeName,y=r.nodeValue,b=r.attributes,T=r.childNodes,w=U(g||N,b||null,r.children||T);return y&&(w.nodeValue=y),w}for(var k=arguments.length,E=new Array(3<k?k-3:0),O=3;O<k;O++)E[O-3]=arguments[O];E.length&&(t=[t].concat(E)),n=H.get();var S=r===B;"string"==typeof r?(n.rawNodeName=r,n.nodeName=n.rawNodeName.toLowerCase()):(n.rawNodeName=r,n.nodeName=z),n.nodeValue="",n.key="",n.childNodes.length=0,n.attributes={};var _=P(e)||"object"!=typeof e?e:t,C=P(_)?_:[_];if(S){var x=C.join("");return n.nodeType=3,n.nodeValue=String(x||""),n}if(n.nodeName===z?n.nodeType=11:n.nodeType="#comment"===r?8:1,_&&C.length)for(var R=0;R<C.length;R++){var I,A,V=C[R];if(P(V)){(I=n.childNodes).push.apply(I,j(V))}else{if(!V)continue;11===V.nodeType&&"string"==typeof V.rawNodeName?(A=n.childNodes).push.apply(A,j(V.childNodes)):V&&"object"==typeof V?n.childNodes.push(U(V)):n.childNodes.push(U(B,null,V))}}return e&&"object"==typeof e&&!P(e)&&(n.attributes=e),"script"===n.nodeName&&n.attributes.src&&(n.key=String(n.attributes.src)),n.attributes&&"key"in n.attributes&&(n.key=String(n.attributes.key)),M.size&&M.forEach(function(e,t){(t=e(n))&&(n=U(t))}),n}var y="undefined"!=typeof process?process:{env:{NODE_ENV:"development"},argv:[]},w="__DIFFHTML__",V=/<!.*>/i,F=new RegExp("".concat(w,"([^_]*)__")),G={tags:[],attributes:{},children:{}},k=Object.assign,E=Array.isArray,Y=["script","noscript","style","code","template"],$=["meta","img","link","input","area","br","hr","area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"],q={li:{li:!0},p:{p:!0,div:!0},td:{td:!0,th:!0},th:{td:!0,th:!0}},J={li:{ul:!0,ol:!0},a:{div:!0},b:{div:!0},i:{div:!0},p:{div:!0},td:{tr:!0,table:!0},th:{tr:!0,table:!0}},K=function(e,t,r){var n;if(!("childNodes"in e.attributes)){if(t&&!V.test(t)&&!F.test(t))return e.childNodes.push(U("#text",t));for(var a=[],o=t.split(F),i=0;i<o.length;i++){var s=o[i];if(s)if(i%2==1){var d=r.children[s],c=s in r.children?d:U("#text","".concat(w).concat(s,"__"));if(!c)continue;var l=11===c.nodeType;"string"==typeof c.rawNodeName&&l?a.push.apply(a,j(c.childNodes)):a.push(c)}else V.test(s)||a.push(U("#text",s))}(n=e.childNodes).push.apply(n,a)}},Q=function(e,t,r,n){var a,o=/\b([_a-z][_a-z0-9\-:]*)\s*(=\s*("([^"]+)"|'([^']+)'|(\S+)))?/gi;if(a=F.exec(e))return Q(r.tags[a[1]],t,r);for(var i,s={};i=o.exec(t||"");){var d,c="string"==typeof e,l=i[1],u=i[6]||i[5]||i[4],f=u||(c?i[1]:u||!0),h=String(f).match(F);if(h&&h.length)for(var p=String(f).split(F),v=F.exec(l),m=v?r.attributes[v[1]]:l,g=0;g<p.length;g++){var N,y,b,T=p[g];T&&(g%2==1?(N="object"==typeof m,y=r.attributes[T],b="".concat(w).concat(T,"__"),s[m]?s[m]+=T in r.attributes?y:b:N?m&&!E(m)&&k(s,m):m&&(s[m]=T in r.attributes?y:b)):s[m]?s[m]+=T:s[m]=T)}else(h=F.exec(l))?"object"!=typeof(d=r.attributes[h[1]])||E(d)?s[d]="":k(s,d):s[l]="''"===f||'""'===f?"":f}return U(e,s,s.childNodes||[])};function b(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};r.parser||(r.parser={}),t=t||G;var n=new Set(r.parser.rawElements?r.parser.rawElements:Y),a=new Set(r.parser.selfClosingElements||$),o=/<!--[^]*?(?=-->)-->|<(\/?)([a-z\-\_][a-z0-9\-\_]*)\s*([^>]*?)(\/?)>/gi,i=U("#document-fragment",null,[]),s=[i],d=i,c=-1;if(!e.includes("<")&&e)return K(d,e,t),i;for(var l,u;l=o.exec(e);0){-1<c&&c+l[0].length<o.lastIndex&&(u=e.slice(c,o.lastIndex-l[0].length))&&K(d,u,t);var f,h=o.lastIndex-l[0].length;if(-1===c&&0<h&&((f=e.slice(0,h))&&!V.exec(f)&&K(d,f,t)),c=o.lastIndex,"!"!==l[0][1]){var p,v,m,g=F.exec(l[2]),N=g&&t.tags[g[1]],y=N?N.name||N:l[2];if(l[1]||(!l[4]&&q[d.rawNodeName]&&q[d.rawNodeName][y]&&(s.pop(),d=s[s.length-1]),d=d.childNodes[d.childNodes.push(Q(l[2],l[3],t))-1],s.push(d),(r.parser.strict||n.has(y))&&(p="</".concat(y,">"),v=e.indexOf(p,o.lastIndex),n.has(y)&&(-1===v?c=o.lastIndex=e.length+1:(c=v+p.length,o.lastIndex=c,l[1]=" "),m=e.slice(l.index+l[0].length,v),K(d,m,t)))),l[1]||l[4]||a.has(y))for(;d;){if("/"===l[4]&&g){s.pop(),d=s[s.length-1];break}if(N&&d.rawNodeName===y){s.pop(),d=s[s.length-1];break}if(d.rawNodeName===y){s.pop(),d=s[s.length-1];break}var b=J[d.rawNodeName];if(!b||!b[y])break;s.pop(),d=s[s.length-1]}}}var T,w,k,E,O,S,_,C,x,R,I,A=e.slice(-1===c?0:c);return A&&K(d,A,t),i.childNodes.length&&"html"===i.childNodes[0].nodeName&&(T={before:[],after:[]},w={after:[]},k=i.childNodes[0],O=E=!0,k.childNodes=k.childNodes.filter(function(e){if("body"===e.nodeName||"head"===e.nodeName)return"head"===e.nodeName&&(E=!1),"body"===e.nodeName&&(O=!1),!0;1===e.nodeType&&(E&&O?T.before.push(e):!E&&O?T.after.push(e):O||w.after.push(e))}),k.childNodes[0]&&"head"===k.childNodes[0].nodeName?((S=k.childNodes[0].childNodes).unshift.apply(S,T.before),S.push.apply(S,T.after)):(_=U("head",null,[]))&&((C=_.childNodes).unshift.apply(C,T.before),C.push.apply(C,T.after),k.childNodes.unshift(_)),k.childNodes[1]&&"body"===k.childNodes[1].nodeName?(x=k.childNodes[1].childNodes).push.apply(x,w.after):(R=U("body",null,[]))&&((I=R.childNodes).push.apply(I,w.after),k.childNodes.push(R))),i}var T=H.protect,O=H.unprotect,S=H.memory;function _(e){T(e);for(var t=0;t<e.childNodes.length;t++)_(e.childNodes[t]);return e}function C(e){O(e);for(var t=0;t<e.childNodes.length;t++)C(e.childNodes[t]);return L.delete(e),e}function x(){S.allocated.forEach(function(e){S.free.add(e),S.allocated.delete(e),L.delete(e)})}var R=Object.freeze({__proto__:null,protectVTree:_,unprotectVTree:C,gc:x}),W=new Map,X="diffHTML",Z="diff_perf",ee="undefined"!=typeof location,te=y.argv,re=function(){};function ne(a,e){var t=ee&&location.search.includes(Z),r=te&&y.argv.includes(Z);if(!(t||r))return re;var o=e;return function(e){var t=a.host;a&&t?e="".concat(t.constructor.name," ").concat(e):o&&"function"==typeof o.rawNodeName&&(e="".concat(o.rawNodeName.name," ").concat(e));var r,n="".concat(e,"-end");W.has(e)?(r=(performance.now()-W.get(e)).toFixed(3),W.delete(e),performance.mark(n),performance.measure("".concat(X," ").concat(e," (").concat(r,"ms)"),e,n)):(W.set(e,performance.now()),performance.mark(e))}}function ae(n){var a=n.state,o=a.isRendering;p.forEach(function(e){var t=e.activeTransaction&&e.activeTransaction.domNode,r=n.domNode;t&&t.contains&&r&&r.contains&&(t.contains(r)&&e.isRendering||r.contains(t)&&e.isRendering)&&(a=e,o=!0)});var e=a.activeTransaction,t=a.nextTransaction;if(o){var r=n.tasks,i=t||e;(a.nextTransaction=n).abort();var s=i.promise||Promise.resolve();return n.promise=s.then(function(){return n.aborted=!1,n.state.isRendering=!0,n.state.activeTransaction=n,Le.flow(n,r.slice(1))})}a.isRendering=!0,a.activeTransaction=n}function oe(e){var t=e.domNode,r=e.markup,n=e.state,a=e.state.measure,o=e.options.inner?"innerHTML":"outerHTML";if(a("should update"),"string"==typeof r&&t[o]===r)return e.abort(!0);"string"==typeof r&&(n.markup=r),a("should update")}function ie(e){var t=p.get(e);if(t&&(p.delete(e),t.oldTree&&!L.has(t.oldTree)&&(C(t.oldTree),c.forEach(function(e){return e(t.oldTree)}))),e){var r=e;if(r.childNodes&&r.childNodes.length)for(var n=0;n<r.childNodes.length;n++)ie(r.childNodes[n]);r.shadowRoot&&ie(r.shadowRoot),L.forEach(function(e,t){e===r&&(C(t),c.forEach(function(e){return e(t)}))})}}function se(e){var t=e.state,r=e.domNode,n=e.markup,a=e.options,o=t.previousMarkup,i=a.inner,s=r.outerHTML;o===s&&t.oldTree&&s||(ie(r),t.oldTree=U(r),_(t.oldTree),p.set(r,t)),e.newTree||(e.newTree=U(n)),e.oldTree=t.oldTree;var d,c,l,u,f=e.oldTree,h=e.newTree;i&&f&&h&&(d=f.nodeName,c=f.attributes,l="string"!=typeof h.rawNodeName,u=11===h.nodeType&&!l?h.childNodes:h,e.newTree=U(d,c,u))}var de={},ce=["old","new"],le="#text";function ue(r,n){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];n=n||de;(r=r||de).nodeName,11===n.nodeType||r.nodeType;var t=r===de,a=null;if(A.forEach(function(e){var t=e(r,n);t&&t===r?a=!0:t&&(n=t)}),a)return e;for(var o={old:new Map,new:new Map},i=0;i<ce.length;i++){var s=o[ce[i]],d=arguments[i],c=d&&d.childNodes;if(c&&c.length)for(var l=0;l<c.length;l++){var u=c[l];u.key&&s.set(u.key,u)}}var f=1===n.nodeType;if(n.nodeName===le){if(r.nodeName===le&&r.nodeValue!==n.nodeValue)return e.push(I.NODE_VALUE,r,n.nodeValue,r.nodeValue),r.nodeValue=n.nodeValue,e;if(t)return e.push(I.NODE_VALUE,n,n.nodeValue,null),e}if(f){var h=t?de:r.attributes,p=n.attributes;for(var v in p){var m=p[v];v in h&&h[v]===p[v]||(t||(h[v]=m),e.push(I.SET_ATTRIBUTE,t?n:r,v,m))}if(!t)for(var g in h)g in p||(e.push(I.REMOVE_ATTRIBUTE,r,g),delete h[g])}var N=n.childNodes||[];if(t){for(var y=0;y<N.length;y++)ue(null,N[y],e,n);return e}for(var b=r.childNodes,T=0;T<N.length;T++){var w=b&&b[T],k=N[T],E=k.key;if(w){var O,S=w.key,_=o.new.has(S),C=o.old.has(E);if(S||E){if(!_&&!C){b.splice(b.indexOf(w),1,k),ue(null,k,e,n),e.push(I.REPLACE_CHILD,k,w),--T;continue}if(!_){e.push(I.REMOVE_CHILD,w),b.splice(b.indexOf(w),1),--T;continue}if(E!==S){var x=k;E&&C?(x=o.old.get(E),b.splice(b.indexOf(x),1)):x=k,ue(null,x,e,r),e.push(I.INSERT_BEFORE,r,x,w),b.splice(T,0,x);continue}}w.nodeName===k.nodeName?ue(w,k,e,r):(b[T]=k,T<(O=b.lastIndexOf(k))&&b.splice(O,1),ue(null,k,e,n),e.push(I.REPLACE_CHILD,k,w))}else b.push(k),ue(null,k,e,r),e.push(I.INSERT_BEFORE,r,k,null)}if(b.length!==N.length){for(var R=N.length;R<b.length;R++)e.push(I.REMOVE_CHILD,b[R]);b.length=N.length}return e}var fe="object"==typeof global?global:window||{},he=Symbol.for("diffHTML"),pe="http://www.w3.org/2000/svg",ve=fe.document||null;function me(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:ve,r=2<arguments.length?arguments[2]:void 0,n=U(e),a=L.get(n);if(a)return a;var o=n.nodeName,i=n.rawNodeName,s=void 0===i?o:i,d=n.childNodes,c=void 0===d?[]:d,r=r||"svg"===o,l=null;v.forEach(function(e,t){(t=e(n))&&(l=t)}),null===l&&(l="#text"===o?t.createTextNode(n.nodeValue||""):"#document-fragment"===o?t.createDocumentFragment():r?t.createElementNS(pe,s):t.createElement(s));var u=l;L.set(n,u);for(var f=0;f<c.length;f++){var h=me(c[f],t,r);u.appendChild(h)}return u}function ge(e){var t=e.state.measure,r=e.oldTree,n=e.newTree,a=e.domNode;t("sync trees"),r&&n&&r.nodeName!==n.nodeName&&11!==n.nodeType?(e.patches=[I.REPLACE_CHILD,n,r],e.oldTree=e.state.oldTree=n,p.delete(a),p.set(me(n),e.state)):e.patches=ue(r||null,n||null,[]),t("sync trees")}var Ne=["attached","detached","replaced","attributeChanged","textChanged"];function ye(e,t){m.get(e).add(t)}function be(e,t){if(!t&&e)m.get(e).clear();else if(e&&t)m.get(e).delete(t);else for(var r=0;r<Ne.length;r++)m.get(Ne[r]).clear()}function Te(t){for(var e=m.get(t),r=[],n=arguments.length,a=new Array(1<n?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];var i=a[0],s=a.slice(1);return!e.size||"textChanged"!==t&&1!==i.nodeType||(e.forEach(function(e){var t=e.apply(void 0,[L.get(i)].concat(j(s)));"object"==typeof t&&t.then&&r.push(t)}),"attached"!==t&&"detached"!==t||i.childNodes.forEach(function(e){r.push.apply(r,j(Te.apply(void 0,[t,e].concat(j(s)))))})),r}Ne.forEach(function(e){return m.set(e,new Set)});var we=fe.document?document.createElement("div"):null;function ke(e){return we&&e&&e.indexOf&&e.includes("&")?(we.innerHTML=e,we.textContent||""):e}var Ee=Object.keys,Oe=new Set,Se=new Set,_e=["class","checked","disabled","selected"],Ce=function(e,t,r,n){var a="object"==typeof n&&n,o="function"==typeof n,i="symbol"==typeof n,s=0===r.indexOf("on")?r.toLowerCase():r,d=e.nodeName+"-"+s,c=t;if(Se.has(d))t[s]=n;else if(!Oe.has(d))try{t[s]=n,Se.add(d)}catch(e){Oe.add(d)}if(a||o||i){if(a&&"style"===s)for(var l=Ee(n),u=0;u<l.length;u++)c.style[l[u]]=n[l[u]]}else{var f=null==n;s&&c.setAttribute(s,f?"":n)}},xe=function(e,t){var r=0===t.indexOf("on");e.removeAttribute(t);var n=e.nodeName+"-"+t;if(Se.has(n)){var a=e;r?a[t]=void 0:delete a[t],_e.includes(t)&&(e[t]=!1)}else if(!Oe.has(n))try{var o=e;r?o[t]=void 0:delete o[t],_e.includes(t)&&(e[t]=!1),Se.add(n)}catch(e){Oe.add(n)}},Re=function(e,t){var r=e;t.includes("&")?r.nodeValue=ke(t):r.nodeValue=t};function Ie(e){var t=e.domNode,r=e.state,n=e.state.measure,a=e.patches,o=t.nodeName,i=t.namespaceURI,s=t.ownerDocument,d=e.promises||[],c=i||"";r.isSVG="svg"===o.toLowerCase()||c.includes("svg"),r.ownerDocument=s||document,n("patch node"),d.push.apply(d,j(function(u,e){for(var t=1<arguments.length&&void 0!==e?e:{},f=[],h=t.isSVG,p=t.ownerDocument,r=u.length,v=0;;){var n=u[v];if(v===r)break;switch(n){case I.SET_ATTRIBUTE:if("break"===function(){var e=u[v+1],t=u[v+2],r=ke(u[v+3]);v+=4;var n=me(e,p,h),a=n.getAttribute(t),o=Te("attributeChanged",e,t,a,r);return _(e),o.length?(Promise.all(o).then(function(){return Ce(e,n,t,r)}),f.push.apply(f,j(o))):Ce(e,n,t,r),"break"}())break;case I.REMOVE_ATTRIBUTE:if("break"===function(){var e=u[v+1],t=u[v+2];v+=3;var r=me(e,p,h),n=r.getAttribute(t),a=Te("attributeChanged",e,t,n,null);return _(e),a.length?(Promise.all(a).then(function(){return xe(r,t)}),f.push.apply(f,j(a))):xe(r,t),"break"}())break;case I.NODE_VALUE:if("break"===function(){var e=u[v+1],t=u[v+2],r=u[v+3];v+=4;var n=me(e,p,h);_(e);var a=Te("textChanged",e,r,t);return a.length?(Promise.all(a).then(function(){return Re(n,t)}),f.push.apply(f,j(a))):Re(n,t),"break"}())break;case I.INSERT_BEFORE:var a=u[v+1],o=u[v+2],i=u[v+3];v+=4;var s=L.get(a);if(!s)break;_(o);var d=i&&me(i,p,h),c=me(o,p,h);s.insertBefore(c,d||null),f.push.apply(f,j(Te("attached",o)));break;case I.REPLACE_CHILD:if("break"===function(){var e=u[v+1],t=u[v+2];v+=3;var r=L.get(t),n=me(e,p,h);if(!r||!r.parentNode)return"break";_(e);var a=m.get("attached").size,o=m.get("detached").size,i=m.get("replaced").size;if(!a&&!o&&!i)return r.parentNode&&(C(t),r.parentNode.replaceChild(n,r)),"break";r.parentNode&&r.parentNode.insertBefore(n,r);var s=Te("attached",e),d=Te("detached",t),c=Te("replaced",t,n),l=[].concat(j(s),j(d),j(c));return l.length?(Promise.all(l).then(function(){r.parentNode&&r.parentNode.removeChild(r),C(t)}),f.push.apply(f,j(l))):(r.parentNode&&r.parentNode.removeChild(r),C(t)),"break"}())break;case I.REMOVE_CHILD:if("break"===function(){var e=u[v+1];v+=2;var t=L.get(e);if(!t||!t.parentNode)return"break";var r=Te("detached",e);return r.length?(Promise.all(r).then(function(){t.parentNode&&t.parentNode.removeChild(t),C(e)}),f.push.apply(f,j(r))):(t.parentNode&&t.parentNode.removeChild(t),C(e)),"break"}())break}}return f}(a,r))),n("patch node"),e.promises=d}function Ae(e){var t=e.promises;return t&&t.length?e.promise=Promise.all(t).then(function(){return e.end()}):e.promise=Promise.resolve(e.end())}var Ve=[ae,oe,se,ge,Ie,Ae],je={schedule:ae,shouldUpdate:oe,reconcileTrees:se,syncTrees:ge,patchNode:Ie,endAsPromise:Ae},Le=function(){function n(e,t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),a(this,"domNode",""),a(this,"markup",""),a(this,"oldTree",void 0),a(this,"newTree",void 0),a(this,"promise",void 0),a(this,"promises",void 0),a(this,"tasks",[]),a(this,"patches",[]),this.domNode=e,this.markup=t,this.options=r,this.state=p.get(e)||{measure:ne(e,t)},r.tasks&&r.tasks.length&&(this.tasks=j(r.tasks)),this.endedCallbacks=new Set,p.set(e,this.state)}return t(n,null,[{key:"create",value:function(e,t,r){return new n(e,t,r)}},{key:"flow",value:function(e,t){for(var r=e,n=0;n<t.length;n++){if(e.aborted)return r;if(void 0!==(r=t[n](e))&&r!==e)return r}return r}},{key:"assert",value:function(){}},{key:"invokeMiddleware",value:function(r){var n=r.tasks;d.forEach(function(e){var t=e(r);t&&n.push(t)})}}]),t(n,[{key:"start",value:function(){var e=this.state.measure,t=this.tasks,r=t.pop();return this.aborted=!1,n.invokeMiddleware(this),e("render"),r&&t.push(r),n.flow(this,t)}},{key:"abort",value:function(e){if(this.aborted=!0,e)return this.tasks[this.tasks.length-1](this)}},{key:"end",value:function(){var t=this,e=this.state,r=this.domNode,n=e.measure;return n("finalize"),this.completed=!0,n("finalize"),n("render"),e.previousMarkup="outerHTML"in r?r.outerHTML:"",e.isRendering=!1,x(),this.endedCallbacks.forEach(function(e){return e(t)}),this.endedCallbacks.clear(),this}},{key:"onceEnded",value:function(e){this.endedCallbacks.add(e)}}]),n}();function Me(e){return e.replace(/[&<>]/g,function(e){return"&#".concat(e.charCodeAt(0),";")})}var He=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach(function(e){a(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({decodeEntities:ke,escape:Me,makeMeasure:ne,memory:R,Pool:H,process:y,PATCH_TYPE:I,createNode:me,syncTree:ue},l);function Pe(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return r.inner=!0,r.tasks=r.tasks||Ve,Le.create(e,t,r).start()}function De(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return r.inner=!1,r.tasks=r.tasks||Ve,Le.create(e,t,r).start()}var ze=Array.isArray,Be=/(<|\/)/,Ue=function(e){var t=e.shift();return"string"==typeof t?Me(ke(t)):t};function Fe(e){for(var t=arguments.length,c=new Array(1<t?t-1:0),r=1;r<t;r++)c[r-1]=arguments[r];var n=U("#text","");if(!e)return n;if("string"==typeof e&&(e=[e]),1===e.length&&!c.length){var a=Fe.isStrict;if(Fe.isStrict=!1,!e[0])return n;var o=b(e[0],void 0,{parser:{strict:a}}).childNodes;return U(1===o.length?o[0]:o)}var l="",u={attributes:{},children:{},tags:{}};e.forEach(function(e,t){var r,n,a,o,i,s,d;l+=e,c.length&&(r=Ue(c),n=l.trim().slice(-1),a=l.lastIndexOf(">")<l.lastIndexOf("<"),o=Boolean(n.match(Be)),i="string"==typeof r,s="object"==typeof r,d="".concat(w).concat(t,"__"),o&&!i?(u.tags[t]=r,l+=d):a?(u.attributes[t]=r,l+=d):ze(r)||s?(u.children[t]=U(r),l+=d):r&&(l+=r))});var i=Fe.isStrict;Fe.isStrict=!1;var s=b(l,u,{parser:{strict:i}}).childNodes;return U(1===s.length?s[0]:s)}function Ge(e){var t="function"==typeof e,r=e.subscribe,n=e.unsubscribe,a=e.createTreeHook,o=e.createNodeHook,i=e.syncTreeHook,s=e.releaseHook;return t&&d.add(e),r&&r(He),a&&M.add(a),o&&v.add(o),i&&A.add(i),s&&c.add(s),function(){t&&d.delete(e),n&&n(He),M.delete(a),v.delete(o),A.delete(i),c.delete(s)}}Fe.isStrict=!1,Fe.strict=function(e){Fe.isStrict=!0;for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Fe.apply(void 0,[e].concat(r))};var Ye="1.0.0-beta.16",$e=Object.assign;Ve.splice(Ve.indexOf(se),0,function(e){var t,r,n=e.state,a=e.markup,o=e.options,i=n.measure,s=o.inner;"string"==typeof a&&(i("parsing markup for new tree"),t=b(a,void 0,o).childNodes,(r=U(!s&&t[0]||t))&&(e.newTree=r),i("parsing markup for new tree"))}),$e(He,{parse:b,defaultTasks:Ve,tasks:je,VERSION:Ye});var qe={};qe.VERSION=Ye,qe.addTransitionState=ye,qe.removeTransitionState=be,qe.release=ie,qe.createTree=U,qe.use=Ge,qe.outerHTML=De,qe.innerHTML=Pe,qe.html=Fe,qe.Internals=He;var Je,Ke=fe;he in fe?(Ye!==(Je=Ke[he]).VERSION&&console.log("Tried to load ".concat(Ye," after ").concat(Je.VERSION)),$e(qe,Ke[he])):(Ke[he]=qe,Ke.devTools&&(Ke.unsubscribeDevTools=Ge(Ke.devTools(He)))),e.Internals=He,e.VERSION=Ye,e.addTransitionState=ye,e.createTree=U,e.default=qe,e.html=Fe,e.innerHTML=Pe,e.outerHTML=De,e.release=ie,e.removeTransitionState=be,e.use=Ge,Object.defineProperty(e,"__esModule",{value:!0})});